<html>
	<head>
		<style>
			#cometchat {
				display: flex;
				flex-flow: row wrap;
				gap: 12px;
			}
		</style>
	</head>

	<body>
		<div id="cometchat"></div>
		<!-- <button class="add_widget">+</button> -->
		<script defer type="module">
			window.addEventListener("DOMContentLoaded", async (event) => {
				const { default: CometChatWidget } = await import("./index.js");

				window.CometChatWidget = CometChatWidget;

				window.CometChatWidgetCount = 0;

				const { CometChat } = CometChatWidget;

				const UID = "1";

				const init = () => {
					CometChatWidget.init({
						appID: "242053eed084c85d",
						appRegion: "us",
						authKey: "3b23a44d08990491dd8ad335f585121465c8ba02",
					}).then(
						(response) => {
							console.log("Initialization completed successfully");
							//You can now call login function.
							CometChatWidget.login({
								uid: UID,
							}).then(
								(response) => {
									CometChatWidget.launch({
										widgetID: "019886dc-0a20-400c-bf9b-f02c9a5325de",
										target: "#cometchat",
										roundedCorners: "true",
										height: "37.5rem",
										width: "37.5rem",
										defaultID: UID, //default UID (user) or GUID (group) to show,
										defaultType: "user", //user or group,
										docked: false,
									}).then(() => {
										window.CometChatWidgetCount++;
									});
								},
								(error) => {
									console.log("User login failed with error:", error);
									//Check the reason for error and take appropriate action.
								}
							);
						},
						(error) => {
							console.log("Initialization failed with error:", error);
							//Check the reason for error and take appropriate action.
						}
					);
				};

				init();

				window.initCometChat = init;

				function closeChat(id) {
					//destory chat with id
					//var chat = js.getElementById(id);
					//destory chat child element
					console.log("chat closed, id is: ", id);
				}

				window.closeChat = closeChat;

				// document.querySelector('.add_widget').addEventListener('click', e=>{
				//     init();

				//     for(const [i,el] of document.querySelectorAll('.app__launcher').entries())
				//     {
				//         el.style.right = `${(i + 1) * 100}px`

				//         console.log(el)
				//     }
				// })
			});
		</script>
	</body>
</html>
